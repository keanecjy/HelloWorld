(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{103:function(e,t,n){},104:function(e,t,n){},105:function(e,t,n){},106:function(e,t,n){},107:function(e,t,n){},108:function(e,t,n){},109:function(e,t,n){},110:function(e,t,n){"use strict";n.r(t);var a=n(2),c=n(1),s=n.n(c),o=n(9),r=n.n(o),i=(n(60),n(10)),l=n(8),u=n(22),d=n(26),j=n.n(d),b=(n(92),["boy1","boy2","boy3","girl1","girl2","girl3"]),m=1.3521,f=103.8198,O=Object(i.a)(Array(200)).fill(0).map((function(e,t){return{_id:t,lat:m+.2*t*Math.sin(Math.PI*t/180)*Math.cos(23*Math.PI*t/180)+Math.sin(t/180),lng:f+.2*t*Math.cos(17*Math.PI*t/180)*Math.sin(5*Math.PI*t/180)+Math.sin(t/180),avatar:b[b.length*Math.random()<<0],username:"User"+t.toString(10),latestMessage:Math.random()<.5?"Hello World!":void 0}})),g=(n(93),n(94),n.p+"static/media/boy1.2e82546e.svg"),h=n.p+"static/media/boy2.59009ebf.svg",p=n.p+"static/media/boy3.e57c8b6c.svg",v=n.p+"static/media/girl1.8a35fe99.svg",x=n.p+"static/media/girl2.a0b1b314.svg",y=n.p+"static/media/girl3.4993fb4c.svg",C={boy1:g,boy2:h,boy3:p,girl1:v,girl2:x,girl3:y},S=n(114),N=function(e){var t=e.currentSelected,n=e.handleSelection;return Object(a.jsx)("div",{className:"grid-container",children:Object.entries(C).map((function(e){var c=Object(l.a)(e,2),s=c[0],o=c[1];return Object(a.jsx)("img",{src:o,alt:"none",className:"image-style",style:{boxShadow:t===s&&"0 0 0 1pt #163CC5"},onClick:function(){return n(s)}},s)}))})},M=function(){var e=j()("http://localhost:5000",{withCredentials:!0,extraHeaders:{"my-custom-header":"abcd"}}),t=Object(c.useContext)(J),n=t.name,s=t.setName,o=t.image,r=t.setImage,i=Object(c.useState)(!1),u=Object(l.a)(i,2),d=u[0],b=u[1];return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(S.a,{show:d,onHide:function(){return b(!1)},size:"lg",dialogClassName:"appear-on-left","aria-labelledby":"contained-modal-title-vcenter",children:Object(a.jsx)(N,{currentSelected:o,handleSelection:function(t){r(t),b(!1),e.emit("inputUpdateUser",{avatar:t})}})}),Object(a.jsxs)("div",{className:"row-flex",children:[Object(a.jsx)("img",{src:o?C[o]:C.boy1,alt:"none",className:"image-style",style:{width:"50px"},onClick:function(){return b(!0)}}),Object(a.jsx)("input",{className:"input-name",placeholder:n,onChange:function(t){var n=t.target.value;s(n),e.emit("inputUpdateUser",{username:n})}})]})]})},P=n(115),I=(n(97),function(){var e=Object(c.useContext)(J),t=e.name,n=e.image,s=e.setName,o=e.setImage,r=e.sendUserInput,i=e.sendMessage,u=Object(c.useState)(!0),d=Object(l.a)(u,2),j=d[0],b=d[1];return Object(a.jsx)(S.a,{show:j,backdrop:"static",keyboard:!1,size:"lg",dialogClassName:"modal-styles","aria-labelledby":"contained-modal-title-vcenter",centered:!0,id:"modal-styles",children:Object(a.jsxs)(P.a,{onSubmit:function(e){return function(e){b(!1),e.preventDefault(),r(t,n),i("Hello everybody, I'm "+t)}(e)},children:[Object(a.jsx)(S.a.Title,{id:"modal-header",children:Object(a.jsx)("p",{children:"What should we call you?"})}),Object(a.jsx)("input",{required:!0,type:"text",placeholder:"input your name",onChange:function(e){return s(e.target.value)},className:"name-box"}),Object(a.jsxs)("div",{className:"row-container",children:[Object(a.jsx)("p",{children:"Pick your avatar"}),Object(a.jsx)(N,{currentSelected:n,handleSelection:o})]}),Object(a.jsx)(S.a.Footer,{id:"modal-footer",children:Object(a.jsx)("button",{type:"submit",className:"my-button",children:"Get chatting!"})})]})})}),E=n(52),_=n(51),w=n.n(_);n(103),n(104),n(105);var k=function(e){var t=e.children;return Object(a.jsx)("div",{className:"speech-bubble",children:t})};var U=function(e){var t=e.handleClick,n=e.avatar,c=e.style;return Object(a.jsx)(a.Fragment,{children:Object(a.jsx)("img",{src:C[n],alt:g,onClick:t,style:c})})};var T=function(e){var t=e.username,n=e.avatar,c=e.message;return Object(a.jsxs)("div",{className:"user",children:[c&&Object(a.jsx)(k,{children:c}),Object(a.jsx)("div",{children:Object(a.jsx)(U,{avatar:n,style:{width:"48px",height:"48px",color:"#fff",border:"2px solid #fff",borderRadius:"50%",backgroundSize:"cover",backgroundPosition:"center"}})}),Object(a.jsx)("p",{className:"user-name",children:t||"unnamed"})]})};n(106);var A=function(e){var t=e.numPoints;return Object(a.jsx)("div",{className:"cluster-group",children:t})};function z(e){return{zoomControlOptions:{position:e.ControlPosition.LEFT_CENTER,style:e.ZoomControlStyle.SMALL}}}var F=function(e){var t=e.users,n=Object(c.useContext)(J),s=n.mapOptions,o=n.setMapOptions,r=Object(c.useState)([]),i=Object(l.a)(r,2),u=i[0],d=i[1];return Object(c.useEffect)((function(){if(s&&s.bounds){var e=w()(t,{minZoom:0,maxZoom:16,radius:60});d(e(s).map((function(e){var t=e.wx,n=e.wy,a=e.numPoints,c=e.points;return{lat:n,lng:t,numPoints:a,id:"".concat(a,"_").concat(c[0]._id),points:c}})))}}),[s,t]),Object(a.jsx)("div",{className:"google-map",children:s&&Object(a.jsx)(E.a,{bootstrapURLKeys:{key:Object({NODE_ENV:"production",PUBLIC_URL:"/HelloWorld",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_GMAPS_API},center:s.center,zoom:s.zoom,onChange:function(e){var t=e.center,n=e.zoom,a=e.bounds;return o({center:t,zoom:n,bounds:a})},yesIWantToUseGoogleMapApiInternals:!0,options:z,children:u.map((function(e){return 1===e.numPoints?Object(a.jsx)(T,{lat:e.points[0].lat,lng:e.points[0].lng,username:e.points[0].username,avatar:e.points[0].avatar,message:e.points[0].latestMessage||null},e.points[0]._id):Object(a.jsx)(A,{lat:e.lat,lng:e.lng,numPoints:e.numPoints},e.id)}))})})};n(107);var L=function(){return Object(a.jsx)("div",{className:"chat-header",children:Object(a.jsx)("h1",{children:"Global Chat"})})};var H=function(e){var t=e.sender,n=e.text,s=e.senderId,o=Object(c.useContext)(J).socketId,r=Object(c.useState)(!1),i=Object(l.a)(r,2),u=i[0],d=i[1];return Object(c.useEffect)((function(){d(o===s)}),[]),Object(a.jsxs)("div",{className:"chat-message",children:[Object(a.jsx)("div",{className:"chat-name",style:{float:u?"right":"left"},children:t}),Object(a.jsx)("div",{className:"chat-bubble",style:u?{float:"right",backgroundColor:"#3AD064"}:{float:"left"},children:n})]})};var R=function(e){var t=e.messages;return Object(a.jsx)("ul",{className:"message-list",children:(t||[]).map((function(e,t){return Object(a.jsx)("li",{children:Object(a.jsx)(H,{sender:e.sender,text:e.text,senderId:e.senderId})},t)}))})},D=n(112);var W=function(){var e=Object(c.useContext)(J).sendMessage,t=Object(c.useState)(""),n=Object(l.a)(t,2),s=n[0],o=n[1];return Object(a.jsx)("form",{onSubmit:function(t){t.preventDefault(),e(s),o("")},className:"chat-form",children:Object(a.jsxs)("div",{className:"standard-row",children:[Object(a.jsx)("input",{className:"chat-form-input",onChange:function(e){return o(e.target.value)},value:s,placeholder:"Type a message...",type:"text"}),Object(a.jsx)("button",{type:"submit",children:Object(a.jsx)(D.a,{color:"#40A7E3",size:"1.2em"})})]})})};var B=function(e){var t=e.messages,n=Object(c.useState)(!0),s=Object(l.a)(n,2),o=s[0],r=s[1];return Object(c.useEffect)((function(){o&&function(e){console.log("Scrolling");var t=document.getElementById(e);t.scrollTop=t.scrollHeight-t.clientHeight}("messages")}),[t,o]),Object(a.jsxs)("div",{className:"column-flex",children:[Object(a.jsx)(L,{onMinimise:r}),o&&Object(a.jsx)("div",{className:"chat-body",id:"messages",children:Object(a.jsx)(R,{messages:t})}),Object(a.jsx)(W,{})]})},G=n(113),K=(n(108),function(e){var t=e.handleClick;return Object(a.jsxs)("button",{onClick:function(){return t()},className:"my-button recenter-button",children:[Object(a.jsx)(G.a,{color:"#ffffff",size:"1.4em"}),"RE-CENTER"]})}),Z=(n(109),function(){var e=Object(c.useContext)(J).numOnline;return Object(a.jsx)("div",{className:"top-right",children:"".concat(e," users online")})}),J=s.a.createContext({}),q={lat:1.3521,lng:103.8198},V=j()("http://localhost:5000",{withCredentials:!0,extraHeaders:{"my-custom-header":"abcd"}});function Q(e){return Object(u.a)(Object(u.a)({},e),{},{lat:parseFloat(e.lat),lng:parseFloat(e.lng)})}var X=function(){var e=Object(c.useState)(""),t=Object(l.a)(e,2),n=t[0],s=t[1],o=Object(c.useState)("boy1"),r=Object(l.a)(o,2),d=r[0],j=r[1],b=Object(c.useState)(null),m=Object(l.a)(b,2),f=m[0],g=m[1],h=Object(c.useState)(O),p=Object(l.a)(h,2),v=p[0],x=p[1],y=Object(c.useState)([]),C=Object(l.a)(y,2),S=C[0],N=C[1],P=Object(c.useState)(0),E=Object(l.a)(P,2),_=E[0],w=E[1],k=Object(c.useState)(!1),U=Object(l.a)(k,2),T=U[0],A=U[1],z=Object(c.useState)(q),L=Object(l.a)(z,2),H=L[0],R=L[1];Object(c.useEffect)((function(){V.on("connect",(function(e){console.log("A new user has connected")})),V.on("status",(function(e){console.log(e)})),V.on("outputUser",(function(e){e.map((function(e){return console.log("user "+e.username+" joined")}));var t=e.map((function(e){return Q(e)}));x((function(e){return[].concat(Object(i.a)(e),Object(i.a)(t))}))})),V.on("outputMessage",(function(e){var t=e.map((function(e){return{_id:(t=e)._id,sender:t.username,senderId:t.userId,text:t.text};var t}));N((function(e){return[].concat(Object(i.a)(e),Object(i.a)(t))}));var n=new Map;e.forEach((function(e){n.set(e.userId,e.text)})),x((function(e){return e.map((function(e){return n.has(e._id)?Object(u.a)(Object(u.a)({},e),{},{latestMessage:n.get(e._id)}):e}))}))})),["outputUpdateUser","outputPosition"].forEach((function(e){V.on(e,(function(e){e.map((function(e){return console.log(e.username+" was modified")}));var t=e.map((function(e){return Q(e)})),n=new Set(t.map((function(e){return e._id})));x((function(t){return[].concat(Object(i.a)(e),Object(i.a)(t.filter((function(e){return!n.has(e._id)}))))}))}))})),V.on("onlineUsers",(function(e){console.log("users: "+e),w(e+O.length)})),V.on("userLeft",(function(e){console.log("user "+e+" left called by "+V.id),x((function(t){return Object(i.a)(t.filter((function(t){return t._id!==e})))}))})),"geolocation"in navigator?(console.log("Location enabled"),navigator.geolocation.getCurrentPosition((function(e){var t={lat:e.coords.latitude,lng:e.coords.longitude};R(t),g({center:t,zoom:15})})),T&&navigator.geolocation.watchPosition((function(e){if(console.log("geolocation changed"),H.lat!==e.coords.latitude||H.lng!==e.coords.longitude){var t={lat:e.coords.latitude,lng:e.coords.longitude};R(t),console.log(t),V.emit("inputPosition",t)}}))):console.log("Location disabled")}),[]),Object(c.useEffect)((function(){console.log("Changed name/avatar"),V.emit("inputUpdateUser",{username:n,avatar:d})}),[n,d]);var D={name:n,setName:s,image:d,setImage:j,mapOptions:f,setMapOptions:g,socketId:V.id,currLocation:H,numOnline:_,sendMessage:function(e){return V.emit("inputMessage",{text:e})},sendUserInput:function(e,t){V.emit("inputUser",{username:e,avatar:t,lat:H.lat,lng:H.lng}),A(!0)}};return Object(a.jsx)("div",{className:"App",children:Object(a.jsxs)(J.Provider,{value:D,children:[Object(a.jsx)(I,{}),Object(a.jsx)(M,{}),Object(a.jsx)(Z,{}),Object(a.jsx)(F,{users:v}),Object(a.jsx)(K,{handleClick:function(){return g({center:H,zoom:15})}}),Object(a.jsx)(B,{messages:S})]})})},Y=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,116)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,s=t.getLCP,o=t.getTTFB;n(e),a(e),c(e),s(e),o(e)}))};r.a.render(Object(a.jsx)(s.a.StrictMode,{children:Object(a.jsx)(X,{})}),document.getElementById("root")),Y()},60:function(e,t,n){},92:function(e,t,n){},93:function(e,t,n){},94:function(e,t,n){},97:function(e,t,n){}},[[110,1,2]]]);
//# sourceMappingURL=main.49929377.chunk.js.map